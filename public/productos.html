<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos - PetShop AutoServicio</title>
    <link rel="icon" type="image/png" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üêæ</text></svg>">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">üêæ</div>
            <h1 class="app-name">PetShop AutoServicio</h1>
            <p class="authors">Desarrollado por: [Tu Nombre] & [Compa√±ero]</p>
            <p class="customer-name">Cliente: <span id="customerNameDisplay"></span></p>
            <nav class="main-nav">
                <a href="index.html">Inicio</a>
                <a href="productos.html" class="active">Productos</a>
                <a href="carrito.html">Carrito <span id="cartBadge" class="badge">0</span></a>
                <a href="C:\Users\fabiola\Desktop\trabajo programacion 3\vistas\inicioadmin.ejs" class="admin-link">Admin üîê</a>
            </nav>
        </header>

        <main class="products-screen">
            <div class="welcome-message">
                <h2>Hola <span id="customerGreeting"></span>! üëã</h2>
                <p>Selecciona los productos que deseas comprar</p>
            </div>

            <!-- Filtros por categor√≠a -->
            <div class="category-filter">
                <button class="filter-btn active" data-category="all">
                    Todos los productos
                </button>
                <button class="filter-btn" data-category="Gato">
                    üê± Productos para Gatos
                </button>
                <button class="filter-btn" data-category="Perro">
                    üê∂ Productos para Perros
                </button>
            </div>

            <!-- Loading y errores -->
            <div id="loadingProducts" class="loading">
                <div class="spinner"></div>
                <p>Cargando productos...</p>
            </div>

            <div id="errorProducts" class="error-box" style="display: none;">
                <p>‚ùå Error al cargar productos. Por favor intenta nuevamente.</p>
                <button onclick="location.reload()" class="btn btn-secondary">Reintentar</button>
            </div>

            <!-- Grid de productos -->
            <div id="productsGrid" class="products-grid"></div>

            <!-- Paginaci√≥n -->
            <div id="pagination" class="pagination" style="display: none;">
                <button id="prevPage" class="btn btn-secondary">‚Üê Anterior</button>
                <span id="pageInfo" class="page-info">P√°gina 1 de 1</span>
                <button id="nextPage" class="btn btn-secondary">Siguiente ‚Üí</button>
            </div>

            <!-- Bot√≥n ir al carrito -->
            <div class="floating-cart-btn">
                <a href="carrito.html" class="btn btn-cart">
                    üõí Ver Carrito (<span id="cartCount">0</span>)
                </a>
            </div>
        </main>

        <footer>
            <p>&copy; 2025 PetShop AutoServicio. Todos los derechos reservados.</p>
        </footer>
    </div>
    <script>
const productsGrid = document.getElementById("productsGrid");
const loading = document.getElementById("loadingProducts");
const errorBox = document.getElementById("errorProducts");

async function cargarProductos(categoria = "all") {
    loading.style.display = "block";
    errorBox.style.display = "none";
    productsGrid.innerHTML = "";

    let url = "/api/productos/activos"; 
    if (categoria !== "all") url += `?categoria=${categoria}`;

    try {
        const res = await fetch(url);
        const data = await res.json();
        const productos = data.productos;

        if (productos.length === 0) {
            productsGrid.innerHTML = "<p>No hay productos disponibles.</p>";
        }

        productos.forEach(p => {
            const div = document.createElement("div");
            div.classList.add("product-card");
            div.innerHTML = `
                <img src="${p.imagen || 'default.png'}" alt="${p.nombre}">
                <h3>${p.nombre}</h3>
                <p>${p.descripcion}</p>
                <p>Precio: $${p.precio}</p>
                <button class="btn btn-primary" onclick="agregarAlCarrito(${p.id})">Agregar al carrito</button>
            `;
            productsGrid.appendChild(div);
        });

        loading.style.display = "none";
    } catch (err) {
        console.error(err);
        loading.style.display = "none";
        errorBox.style.display = "block";
    }
}

// Filtrar por categor√≠a
document.querySelectorAll(".filter-btn").forEach(btn => {
    btn.addEventListener("click", () => {
        document.querySelectorAll(".filter-btn").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        cargarProductos(btn.dataset.category);
    });
});

// Llamar al cargar la p√°gina
cargarProductos();

function agregarAlCarrito(id) {
    console.log("Producto agregado al carrito:", id);
}
</script>

    <script src="js/config.js"></script>
    <script src="ORM/js/productos.js"></script>

</body>
</html>